# Example dataset
This folder contains a small example dataset that can be used to test our evaluation tools. Sample dataset contains only one group, and was simulated using PBSIM on _D. Melanogaster_ chromosome 4, with coverage 5 and with PacBio ROI parameters. Simulation files (generated by PBSIM) are placed in a folder __group1__, inside a root simulation folder __simulation\_X5__. Headers in the generated fastq file were adjusted as described in [RNAseq_benchmark/Data_preparation.md](/RNAseq_benchmark/Data_preparation.md)

Sample dataset contains 2955 reads.

The folder also contains all files needed to test the dataset and the tools.

Contents of the folder:
- example.fastq - small test dataset, 
- example.sam   - mapping of the example dataset to the reference genome using GraphMap (https://github.com/isovic/graphmap) and it option to map RNA reads with the help of annotations.
- dmelanogaster_chr_genome.fa  - genomic sequence for _D. Melanogaster_ chromosome 4, this represents a reference genome for our example dataset
- dmelanogaster_chr.gft - gene annotations for _D. Melanogaster_ chromosome 4
- dmelanogaster_chr_trans_F.fa - transcriptome for for _D. Melanogaster_ chromosome 4, this is generated from geneomic sequence and annotations using [generate_transcriptome.py](/generate_transcriptome.py). DEsignation '\_F' means that the transcriptome has been filtered, removing sequences shorter than 100 base-pairs, as required by PBSIM.

### Determining match rate
Matchrate for SAM file contining mappings can be determined using errorrates.py script from https://github.com/isovic/samscripts.

    python /home/kkrizanovic/src/samscripts/src/errorrates.py base dmelanogaster_chr4_genome.fa sample.sam

### Runnning Process_pbsim_data.py
Evaluation of simulated data is performed using Process_pbsim_data.py script. It requires files generated by PBSIM during simulation proces.

    python /home/kkrizanovic/src/RNAseqEval/Process_pbsim_data.py process ./simulation_X5/ sample.sam dmelanogaster_chr4.gtf

### Running RNAseqEval.py
Evaluation of real data is performed using RNAseqEval.py script. It requires gene annotations for comparison to mappings.

    python /home/kkrizanovic/src/RNAseqEval/RNAseqEval.py eval-mapping dmelanogaster_chr4_genome.fa sample.sam -a dmelanogaster_chr4.gtf

